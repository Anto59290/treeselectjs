import t from"@swc/helpers/src/_class_private_field_get.mjs";import e from"@swc/helpers/src/_class_private_field_init.mjs";import s from"@swc/helpers/src/_class_private_field_set.mjs";import i from"@swc/helpers/src/_class_private_method_get.mjs";import n from"@swc/helpers/src/_class_private_method_init.mjs";const l={arrowUp:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg>',arrowDown:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>',arrowRight:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>',attention:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',clear:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',cross:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',check:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',partialCheck:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>'},o=(t,e)=>{if(e.innerHTML="","string"==typeof t)e.innerHTML=t;else{const s=t.cloneNode(!0);e.appendChild(s)}},c=t=>{const e=t?{...t}:{};return Object.keys(l).forEach((t=>{e[t]||(e[t]=l[t])})),e};var a=new WeakMap,h=new WeakMap,r=new WeakMap,d=new WeakMap,u=new WeakSet,p=new WeakSet,m=new WeakSet,v=new WeakSet,w=new WeakSet,f=new WeakSet,E=new WeakSet,k=new WeakSet,g=new WeakSet,L=new WeakSet,_=new WeakSet,b=new WeakSet,y=new WeakSet,S=new WeakSet,x=new WeakSet,W=new WeakSet,C=new WeakSet,O=new WeakSet,T=new WeakSet,A=new WeakSet,H=new WeakSet,B=new WeakSet,M=new WeakSet,P=new WeakSet,N=new WeakSet,G=new WeakSet;function j(){i(this,p,q).call(this),i(this,w,V).call(this),i(this,m,D).call(this)}function q(){t(this,a).innerHTML="",this.showTags?t(this,a).append(...i(this,L,Y).call(this)):t(this,a).appendChild(i(this,S,X).call(this))}function D(){const e=[];t(this,r).innerHTML="",this.clearable&&e.push(i(this,T,st).call(this)),this.isAlwaysOpened||e.push(i(this,H,nt).call(this,this.isOpened)),e.length&&t(this,r).append(...e)}function I(){if(!this.isAlwaysOpened&&t(this,d)){const e=this.isOpened?this.iconElements.arrowUp:this.iconElements.arrowDown;o(e,t(this,d))}}function V(){var e;(null===(e=this.value)||void 0===e?void 0:e.length)?t(this,h).removeAttribute("placeholder"):t(this,h).setAttribute("placeholder",this.placeholder),this.searchable?this.srcElement.classList.remove("treeselect-input--unsearchable"):this.srcElement.classList.add("treeselect-input--unsearchable"),t(this,h).value=this.searchText}function $(){this.isOpened=!this.isOpened,i(this,v,I).call(this),this.isOpened?i(this,N,at).call(this):i(this,G,ht).call(this)}function R(t,e,s){const n=document.createElement("div");return n.classList.add("treeselect-input"),n.setAttribute("tabindex","-1"),n.addEventListener("mousedown",(t=>i(this,k,z).call(this,t))),n.append(t,e,s),n}function z(t){t.preventDefault(),this.isOpened||i(this,f,$).call(this),this.focus()}function U(){const t=document.createElement("div");return t.classList.add("treeselect-input__tags"),t}function Y(){return this.value.map((t=>{const e=document.createElement("div");e.classList.add("treeselect-input__tags-element"),e.setAttribute("tabindex","-1"),e.setAttribute("tag-id",t.id.toString()),e.setAttribute("title",t.name);const s=i(this,b,J).call(this,t.name),n=i(this,y,K).call(this);return e.addEventListener("mousedown",(e=>i(this,_,F).call(this,e,t.id))),e.append(s,n),e}))}function F(t,e){t.preventDefault(),t.stopPropagation(),this.focus(),this.removeItem(e)}function J(t){const e=document.createElement("span");return e.classList.add("treeselect-input__tags-name"),e.innerHTML=t,e}function K(){const t=document.createElement("span");return t.classList.add("treeselect-input__tags-cross"),o(this.iconElements.cross,t),t}function X(){const t=document.createElement("span");return t.classList.add("treeselect-input__tags-count"),this.value.length?(t.innerHTML=1===this.value.length?this.value[0].name:`${this.value.length} ${this.tagsCountText}`,t):(t.innerHTML="",t)}function Q(){const t=document.createElement("input");return t.classList.add("treeselect-input__edit"),t.setAttribute("id",this.id),this.disabled&&t.setAttribute("tabindex","-1"),t.addEventListener("keydown",(t=>i(this,W,Z).call(this,t))),t.addEventListener("input",(e=>i(this,C,tt).call(this,e,t))),t}function Z(t){"Backspace"!==t.key||this.searchText.length||!this.value.length||this.showTags||this.clear(),"Backspace"===t.key&&!this.searchText.length&&this.value.length&&this.removeItem(this.value[this.value.length-1].id),"Space"!==t.code||this.searchText&&this.searchable||i(this,f,$).call(this)}function tt(t,e){t.stopPropagation();const s=this.searchText,n=e.value.trim();if(0!==s.length||0!==n.length){if(this.searchable){const e=t.target.value;i(this,P,ct).call(this,e),this.isOpened||i(this,f,$).call(this)}else e.value="";this.searchText=e.value}else e.value=""}function et(){const t=document.createElement("div");return t.classList.add("treeselect-input__operators"),t}function st(){const t=document.createElement("span");return t.classList.add("treeselect-input__clear"),t.setAttribute("tabindex","-1"),o(this.iconElements.clear,t),t.addEventListener("mousedown",(t=>i(this,A,it).call(this,t))),t}function it(e){var s;e.preventDefault(),e.stopPropagation(),null===(s=t(this,h))||void 0===s||s.focus(),(this.searchText.length||this.value.length)&&this.clear()}function nt(e){s(this,d,document.createElement("span")),t(this,d).classList.add("treeselect-input__arrow");const n=e?this.iconElements.arrowUp:this.iconElements.arrowDown;return o(n,t(this,d)),t(this,d).addEventListener("mousedown",(t=>i(this,B,lt).call(this,t))),t(this,d)}function lt(t){t.stopPropagation(),t.preventDefault(),this.focus(),i(this,f,$).call(this)}function ot(){this.srcElement.dispatchEvent(new CustomEvent("input",{detail:this.value}))}function ct(t){this.srcElement.dispatchEvent(new CustomEvent("search",{detail:t}))}function at(){this.srcElement.dispatchEvent(new CustomEvent("open"))}function ht(){this.srcElement.dispatchEvent(new CustomEvent("close"))}var rt=class{focus(){t(this,h).focus()}blur(){this.isOpened&&i(this,f,$).call(this)}updateValue(t){this.value=t,i(this,p,q).call(this),i(this,w,V).call(this)}removeItem(t){this.value=this.value.filter((e=>e.id!==t)),i(this,M,ot).call(this),i(this,p,q).call(this),i(this,w,V).call(this)}clear(){this.value=[],this.searchText="",i(this,P,ct).call(this,""),i(this,M,ot).call(this),i(this,p,q).call(this),i(this,w,V).call(this)}openClose(){i(this,f,$).call(this)}constructor({value:l,showTags:o,tagsCountText:c,clearable:q,isAlwaysOpened:D,searchable:I,placeholder:V,disabled:$,id:z,iconElements:Y}){n(this,u),n(this,p),n(this,m),n(this,v),n(this,w),n(this,f),n(this,E),n(this,k),n(this,g),n(this,L),n(this,_),n(this,b),n(this,y),n(this,S),n(this,x),n(this,W),n(this,C),n(this,O),n(this,T),n(this,A),n(this,H),n(this,B),n(this,M),n(this,P),n(this,N),n(this,G),e(this,a,{writable:!0,value:void 0}),e(this,h,{writable:!0,value:void 0}),e(this,r,{writable:!0,value:void 0}),e(this,d,{writable:!0,value:void 0}),this.value=l,this.showTags=o,this.tagsCountText=c,this.searchable=I,this.placeholder=V,this.clearable=q,this.isAlwaysOpened=D,this.disabled=$,this.id=z,this.iconElements=Y,this.isOpened=!1,this.searchText="",s(this,a,i(this,g,U).call(this)),s(this,h,i(this,x,Q).call(this)),s(this,r,i(this,O,et).call(this)),s(this,d,null),this.srcElement=i(this,E,R).call(this,t(this,a),t(this,h),t(this,r)),i(this,u,j).call(this)}};const dt=(t,e,s="",i=0)=>t.reduce(((t,n)=>{var l;const o=!!(null===(l=n.children)||void 0===l?void 0:l.length),c=i>=e&&o,a=i>e;if(t.push({id:n.value,name:n.name,childOf:s,isGroup:o,checked:!1,isPartialChecked:!1,level:i,isClosed:c,hidden:a}),o){const s=dt(n.children,e,n.value,i+1);t.push(...s)}return t}),[]),ut=({id:t,checked:e},s)=>{s.forEach((i=>{i.childOf===t&&(i.checked=null==e||e,i.isPartialChecked=!1,i.isGroup&&ut(i,s))}))},pt=(t,e)=>{const s=e.find((e=>e.id===t)),i=e.filter((t=>t.childOf===(null==s?void 0:s.id)));if(!s)return;const n=i.every((t=>t.checked)),l=i.some((t=>t.isPartialChecked||t.checked))&&!n,o=!n&&!l;n&&(s.checked=!0,s.isPartialChecked=!1),l&&(s.checked=!1,s.isPartialChecked=!0),o&&(s.checked=!1,s.isPartialChecked=!1),s.childOf&&pt(s.childOf,e)},mt=({id:t,isGroup:e,childOf:s,checked:i},n)=>{e&&ut({id:t,checked:i},n),s&&pt(s,n)},vt=(t,e)=>e.reduce(((s,i)=>(i.childOf===t&&(s.push(i),i.isGroup&&s.push(...vt(i.id,e))),s)),[]),wt=(t,e)=>e.reduce(((s,i)=>(i.id===t&&(s.push(i),i.childOf&&s.push(...wt(i.childOf,e))),s)),[]),ft=t=>{const{onlyGroupsIds:e,allItems:s}=t.reduce(((t,e)=>e.checked?(e.isGroup&&t.onlyGroupsIds.push(e.id),t.allItems.push(e),t):t),{onlyGroupsIds:[],allItems:[]});return s.filter((t=>!e.some((e=>e===t.childOf))))},Et=(t,{id:e,isClosed:s})=>{t.filter((t=>t.childOf===e)).forEach((e=>{e.hidden=null!=s&&s,e.isGroup&&!e.isClosed&&Et(t,{id:e.id,isClosed:s})}))},kt=(t,e)=>{const s=((t,e)=>t.reduce(((s,i)=>{if(i.name.toLowerCase().includes(e.toLowerCase())){if(s.push(i),i.isGroup){const e=vt(i.id,t);s.push(...e)}if(i.childOf){const e=wt(i.childOf,t);s.push(...e)}}return s}),[]))(t,e);t.forEach((e=>{s.some((t=>t.id===e.id))?(e.isGroup&&(e.isClosed=!1,Et(t,e)),e.hidden=!1):e.hidden=!0}))},gt=(t,e)=>{(t=>{t.forEach((t=>{t.checked=!1,t.isPartialChecked=!1}))})(e);e.filter((e=>t.some((t=>t===e.id)))).forEach((t=>{t.checked=!0,t.isPartialChecked=!1,mt(t,e)}))},Lt=(t,e,s,i)=>{gt(t,e),_t(e,s,i)},_t=(t,e,s)=>{t.forEach((i=>{const n=e.querySelector(`[input-id="${i.id}"]`),l=Tt(n);n.checked=i.checked,bt(i,l),yt(i,l),St(i,l,s),xt(i,l),Ct(i,l,t),Wt(i,n,s)})),Ot(t,e)},bt=(t,e)=>{t.checked?e.classList.add("treeselect-list__item--checked"):e.classList.remove("treeselect-list__item--checked")},yt=(t,e)=>{t.isPartialChecked?e.classList.add("treeselect-list__item--partial-checked"):e.classList.remove("treeselect-list__item--partial-checked")},St=(t,e,s)=>{if(t.isGroup){const i=e.querySelector(".treeselect-list__item-icon"),n=t.isClosed?s.arrowRight:s.arrowDown;o(n,i),t.isClosed?e.classList.add("treeselect-list__item--closed"):e.classList.remove("treeselect-list__item--closed")}},xt=(t,e)=>{t.hidden?e.classList.add("treeselect-list__item--hidden"):e.classList.remove("treeselect-list__item--hidden")},Wt=(t,e,s)=>{const i=e.parentNode.querySelector(".treeselect-list__item-checkbox-icon");t.checked?o(s.check,i):t.isPartialChecked?o(s.partialCheck,i):i.innerHTML=""},Ct=(t,e,s)=>{if(0===t.level){const i=s.some((e=>e.isGroup&&e.level===t.level)),n=!t.isGroup&&i?"20px":"5px";e.style.paddingLeft=t.isGroup?"0":n}else e.style.paddingLeft=t.isGroup?20*t.level+"px":20*t.level+20+"px";e.setAttribute("level",t.level.toString()),e.setAttribute("group",t.isGroup.toString())},Ot=(t,e)=>{const s=t.some((t=>!t.hidden)),i=e.querySelector(".treeselect-list__empty");s?i.classList.add("treeselect-list__empty--hidden"):i.classList.remove("treeselect-list__empty--hidden")},Tt=t=>t.parentNode.parentNode,At=(t,e)=>e.find((e=>e.id.toString()===t));var Ht=new WeakMap,Bt=new WeakMap,Mt=new WeakSet,Pt=new WeakSet,Nt=new WeakSet,Gt=new WeakSet,jt=new WeakSet,qt=new WeakSet,Dt=new WeakSet,It=new WeakSet,Vt=new WeakSet,$t=new WeakSet,Rt=new WeakSet,zt=new WeakSet,Ut=new WeakSet,Yt=new WeakSet,Ft=new WeakSet,Jt=new WeakSet,Kt=new WeakSet,Xt=new WeakSet,Qt=new WeakSet,Zt=new WeakSet,te=new WeakSet,ee=new WeakSet,se=new WeakSet,ie=new WeakSet,ne=new WeakSet;function le(t,e){if(!t)return;const s=t.querySelector(".treeselect-list__item-checkbox").getAttribute("input-id"),i=At(s,this.flattedOptions),n=t.querySelector(".treeselect-list__item-icon");"ArrowLeft"!==e||i.isClosed||n.dispatchEvent(new Event("mousedown")),"ArrowRight"===e&&i.isClosed&&n.dispatchEvent(new Event("mousedown"))}function oe(t,e){const s=Array.from(this.srcElement.querySelectorAll(".treeselect-list__item-checkbox")).filter((t=>"none"!==window.getComputedStyle(Tt(t)).display));if(s.length)if(t){const t=s.findIndex((t=>Tt(t).classList.contains("treeselect-list__item--focused")));Tt(s[t]).classList.remove("treeselect-list__item--focused");const n="ArrowDown"===e?t+1:t-1,l="ArrowDown"===e?0:s.length-1;var i;const o=null!==(i=s[n])&&void 0!==i?i:s[l],c=!s[n],a=Tt(o);a.classList.add("treeselect-list__item--focused");const h=this.srcElement.getBoundingClientRect(),r=a.getBoundingClientRect();if(c&&"ArrowDown"===e)return void this.srcElement.scroll(0,0);if(c&&"ArrowUp"===e)return void this.srcElement.scroll(0,this.srcElement.scrollHeight);if(h.y+h.height<r.y+r.height)return void this.srcElement.scroll(0,this.srcElement.scrollTop+r.height);if(h.y>r.y)return void this.srcElement.scroll(0,this.srcElement.scrollTop-r.height)}else{Tt(s[0]).classList.add("treeselect-list__item--focused")}}function ce(){const t=i(this,Gt,ae).call(this),e=i(this,Dt,de).call(this,this.options);t.append(...e);const s=i(this,It,ue).call(this);s&&t.append(s);const n=i(this,Vt,pe).call(this);return t.append(n),t}function ae(){const t=document.createElement("div");return t.classList.add("treeselect-list"),t.addEventListener("mouseout",(t=>i(this,jt,he).call(this,t))),t.addEventListener("mousemove",(()=>i(this,qt,re).call(this))),t}function he(e){e.stopPropagation(),t(this,Ht)&&t(this,Bt)&&t(this,Ht).classList.add("treeselect-list__item--focused")}function re(){s(this,Bt,!0)}function de(t){return t.reduce(((t,e)=>{var s;if(null===(s=e.children)||void 0===s?void 0:s.length){const s=i(this,$t,me).call(this,e),n=i(this,Dt,de).call(this,e.children);return s.append(...n),t.push(s),t}const n=i(this,Rt,ve).call(this,e,!1);return t.push(n),t}),[])}function ue(){if(!this.listSlotHtmlComponent)return null;const t=document.createElement("div");return t.classList.add("treeselect-list__slot"),t.appendChild(this.listSlotHtmlComponent),t}function pe(){const t=document.createElement("div");t.classList.add("treeselect-list__empty"),t.setAttribute("title",this.emptyText);const e=document.createElement("span");e.classList.add("treeselect-list__empty-icon"),o(this.iconElements.attention,e);const s=document.createElement("span");return s.classList.add("treeselect-list__empty-text"),s.innerHTML=this.emptyText,t.append(e,s),t}function me(t){const e=document.createElement("div");e.setAttribute("group-container-id",t.value.toString()),e.classList.add("treeselect-list__group-container");const s=i(this,Rt,ve).call(this,t,!0);return e.appendChild(s),e}function ve(t,e){const s=i(this,zt,we).call(this,t);if(e){const t=i(this,Jt,ge).call(this);s.appendChild(t)}const n=i(this,Xt,_e).call(this,t),l=i(this,Qt,be).call(this,t);return s.append(n,l),s}function we(t){const e=document.createElement("div");return e.setAttribute("tabindex","-1"),e.setAttribute("title",t.name),e.classList.add("treeselect-list__item"),e.addEventListener("mouseover",(()=>i(this,Ut,fe).call(this,e)),!0),e.addEventListener("mouseout",(()=>i(this,Yt,Ee).call(this,e)),!0),e.addEventListener("mousedown",(e=>i(this,Ft,ke).call(this,e,t))),e}function fe(e){t(this,Bt)&&i(this,ee,xe).call(this,!0,e)}function Ee(e){t(this,Bt)&&(i(this,ee,xe).call(this,!1,e),s(this,Ht,e))}function ke(t,e){t.stopPropagation();const s=t.target.querySelector(".treeselect-list__item-checkbox");s.checked=!s.checked,i(this,Zt,ye).call(this,s,e)}function ge(){const t=document.createElement("span");return t.setAttribute("tabindex","-1"),t.classList.add("treeselect-list__item-icon"),o(this.iconElements.arrowDown,t),t.addEventListener("mousedown",(t=>i(this,Kt,Le).call(this,t))),t}function Le(t){t.stopPropagation(),i(this,te,Se).call(this,t)}function _e(t){const e=document.createElement("div");e.classList.add("treeselect-list__item-checkbox-container");const s=document.createElement("span");s.classList.add("treeselect-list__item-checkbox-icon"),s.innerHTML="";const i=document.createElement("input");return i.setAttribute("tabindex","-1"),i.setAttribute("type","checkbox"),i.setAttribute("input-id",t.value.toString()),i.classList.add("treeselect-list__item-checkbox"),e.append(s,i),e}function be(t){const e=document.createElement("label");return e.innerHTML=t.name,e.classList.add("treeselect-list__item-label"),e}function ye(t,e){const s=this.flattedOptions.find((t=>t.id===e.value));s&&(s.checked=t.checked,s.isPartialChecked=!1,mt(s,this.flattedOptions),_t(this.flattedOptions,this.srcElement,this.iconElements),i(this,ne,Oe).call(this))}function Se(t){var e,s;const n=null===(e=t.target)||void 0===e||null===(s=e.parentNode)||void 0===s?void 0:s.querySelector("[input-id]");var l;const o=null!==(l=null==n?void 0:n.getAttribute("input-id"))&&void 0!==l?l:null,c=At(o,this.flattedOptions);c&&(c.isClosed=!c.isClosed,Et(this.flattedOptions,c),_t(this.flattedOptions,this.srcElement,this.iconElements),i(this,ie,Ce).call(this))}function xe(t,e){const s="treeselect-list__item--focused";if(t){const t=Array.from(this.srcElement.querySelectorAll(`.${s}`));t.length&&t.forEach((t=>t.classList.remove(s))),e.classList.add(s)}else e.classList.remove(s)}function We(){var t;this.selectedNodes={nodes:(t=this.flattedOptions,t.filter((t=>t.checked&&!t.isGroup))),groupedNodes:ft(this.flattedOptions)}}function Ce(){this.srcElement.dispatchEvent(new CustomEvent("arrow-click"))}function Oe(){i(this,se,We).call(this),this.srcElement.dispatchEvent(new CustomEvent("input",{detail:this.selectedNodes}))}var Te=class{updateValue(t){Lt(t,this.flattedOptions,this.srcElement,this.iconElements),i(this,se,We).call(this)}updateSearchValue(t){if(t===this.searchText)return;const e=""===this.searchText&&""!==t;this.searchText=t,e&&(this.flattedOptionsBeforeSearch=JSON.parse(JSON.stringify(this.flattedOptions))),""===this.searchText&&(this.flattedOptions=this.flattedOptionsBeforeSearch.map((t=>{const e=this.flattedOptions.find((e=>e.id===t.id));return e.isClosed=t.isClosed,e.hidden=t.hidden,e})),this.flattedOptionsBeforeSearch=[]),this.searchText&&kt(this.flattedOptions,t),_t(this.flattedOptions,this.srcElement,this.iconElements),this.focusFirstListElement()}callKeyAction(t){s(this,Bt,!1);const e=this.srcElement.querySelector(".treeselect-list__item--focused");"Enter"===t&&e&&e.dispatchEvent(new Event("mousedown")),"ArrowLeft"!==t&&"ArrowRight"!==t||i(this,Mt,le).call(this,e,t),"ArrowDown"!==t&&"ArrowUp"!==t||i(this,Pt,oe).call(this,e,t)}focusFirstListElement(){const t="treeselect-list__item--focused",e=this.srcElement.querySelector(`.${t}`),s=Array.from(this.srcElement.querySelectorAll(".treeselect-list__item-checkbox")).filter((t=>"none"!==window.getComputedStyle(Tt(t)).display));if(!s.length)return;e&&e.classList.remove(t);Tt(s[0]).classList.add(t)}constructor({options:t,value:s,openLevel:l,listSlotHtmlComponent:o,emptyText:c,iconElements:a}){n(this,Mt),n(this,Pt),n(this,Nt),n(this,Gt),n(this,jt),n(this,qt),n(this,Dt),n(this,It),n(this,Vt),n(this,$t),n(this,Rt),n(this,zt),n(this,Ut),n(this,Yt),n(this,Ft),n(this,Jt),n(this,Kt),n(this,Xt),n(this,Qt),n(this,Zt),n(this,te),n(this,ee),n(this,se),n(this,ie),n(this,ne),e(this,Ht,{writable:!0,value:null}),e(this,Bt,{writable:!0,value:!0}),this.options=t,this.value=s,this.openLevel=null!=l?l:0,this.listSlotHtmlComponent=null!=o?o:null,this.emptyText=null!=c?c:"No results found...",this.iconElements=a,this.searchText="",this.flattedOptions=dt(this.options,this.openLevel),this.flattedOptionsBeforeSearch=this.flattedOptions,this.selectedNodes={nodes:[],groupedNodes:[]},this.srcElement=i(this,Nt,ce).call(this),this.updateValue(this.value),(t=>{const{duplications:e}=t.reduce(((t,e)=>(t.allItems.some((t=>t.toString()===e.id.toString()))&&t.duplications.push(e.id),t.allItems.push(e.id),t)),{duplications:[],allItems:[]});e.length&&console.error(`Validation: You have duplicated values: ${e.join(", ")}! You should use unique values.`)})(this.flattedOptions)}};const Ae=t=>t.map((t=>t.id));var He=new WeakMap,Be=new WeakMap,Me=new WeakMap,Pe=new WeakMap,Ne=new WeakMap,Ge=new WeakMap,je=new WeakMap,qe=new WeakSet,De=new WeakSet,Ie=new WeakSet,Ve=new WeakSet,$e=new WeakSet,Re=new WeakSet,ze=new WeakSet,Ue=new WeakSet,Ye=new WeakSet,Fe=new WeakSet,Je=new WeakSet,Ke=new WeakSet,Xe=new WeakSet,Qe=new WeakSet;function Ze(){const t=this.parentHtmlContainer;t.classList.add("treeselect");const e=new Te({options:this.options,value:this.value,openLevel:this.openLevel,listSlotHtmlComponent:this.listSlotHtmlComponent,emptyText:this.emptyText,iconElements:this.iconElements}),{groupedNodes:n,nodes:l}=e.selectedNodes,o=new rt({value:this.grouped?n:l,showTags:this.showTags,tagsCountText:this.tagsCountText,clearable:this.clearable,isAlwaysOpened:this.alwaysOpen,searchable:this.searchable,placeholder:this.placeholder,disabled:this.disabled,id:this.id,iconElements:this.iconElements});return this.appendToBody&&s(this,Me,new ResizeObserver((()=>this.updateListPosition()))),o.srcElement.addEventListener("input",(t=>i(this,De,ts).call(this,t,e))),o.srcElement.addEventListener("open",(()=>i(this,Ue,os).call(this))),o.srcElement.addEventListener("keydown",(t=>i(this,Ie,es).call(this,t,e))),o.srcElement.addEventListener("search",(t=>i(this,Ve,ss).call(this,t,e))),o.srcElement.addEventListener("focus",(()=>i(this,$e,is).call(this)),!0),this.alwaysOpen||o.srcElement.addEventListener("close",(()=>i(this,Ye,cs).call(this))),e.srcElement.addEventListener("mouseup",(()=>o.focus()),!0),e.srcElement.addEventListener("input",(t=>i(this,Re,ns).call(this,t,o))),e.srcElement.addEventListener("arrow-click",(()=>i(this,ze,ls).call(this,o))),t.append(o.srcElement),{container:t,list:e,input:o}}function ts(t,e){const s=Ae(t.detail);e.updateValue(s);const{nodes:n}=e.selectedNodes;this.value=Ae(n),i(this,Qe,us).call(this)}function es(t,e){this.isListOpened&&e.callKeyAction(t.key)}function ss(t,e){e.updateSearchValue(t.detail),this.updateListPosition()}function is(){i(this,Je,hs).call(this,!0),t(this,Ge)&&t(this,Ge)&&t(this,je)&&(document.addEventListener("mousedown",t(this,Ge),!0),document.addEventListener("focus",t(this,Ge),!0),window.addEventListener("blur",t(this,je)))}function ns(t,e){const{groupedNodes:s,nodes:n}=t.detail,l=this.grouped?s:n;e.updateValue(l),this.value=Ae(n),e.focus(),i(this,Qe,us).call(this)}function ls(t){t.focus(),this.updateListPosition()}function os(){if(this.isListOpened=!0,t(this,Pe)&&t(this,Ne)&&(window.addEventListener("scroll",t(this,Pe),!0),window.addEventListener("resize",t(this,Ne))),t(this,He)&&this.srcElement){var e;if(this.appendToBody)document.body.appendChild(t(this,He).srcElement),null===(e=t(this,Me))||void 0===e||e.observe(this.srcElement);else this.srcElement.appendChild(t(this,He).srcElement);this.updateListPosition(),i(this,Ke,rs).call(this,!0),t(this,He).focusFirstListElement()}}function cs(){if(this.isListOpened=!1,t(this,Pe)&&t(this,Ne)&&(window.removeEventListener("scroll",t(this,Pe),!0),window.removeEventListener("resize",t(this,Ne))),!t(this,He)||!this.srcElement)return;if(this.appendToBody?document.body.contains(t(this,He).srcElement):this.srcElement.contains(t(this,He).srcElement)){var e;if(this.appendToBody)document.body.removeChild(t(this,He).srcElement),null===(e=t(this,Me))||void 0===e||e.disconnect();else this.srcElement.removeChild(t(this,He).srcElement);i(this,Ke,rs).call(this,!1)}}function as(e,s){if(!t(this,He)||!t(this,Be))return;const i=s?"treeselect-list--top-to-body":"treeselect-list--top",n=s?"treeselect-list--bottom-to-body":"treeselect-list--bottom";e?(t(this,He).srcElement.classList.add(i),t(this,He).srcElement.classList.remove(n),t(this,Be).srcElement.classList.add("treeselect-input--top"),t(this,Be).srcElement.classList.remove("treeselect-input--bottom")):(t(this,He).srcElement.classList.remove(i),t(this,He).srcElement.classList.add(n),t(this,Be).srcElement.classList.remove("treeselect-input--top"),t(this,Be).srcElement.classList.add("treeselect-input--bottom"))}function hs(e){t(this,Be)&&t(this,He)&&(e?(t(this,Be).srcElement.classList.add("treeselect-input--focused"),t(this,He).srcElement.classList.add("treeselect-list--focused")):(t(this,Be).srcElement.classList.remove("treeselect-input--focused"),t(this,He).srcElement.classList.remove("treeselect-list--focused")))}function rs(e){var s,i,n,l;e?null===(s=t(this,Be))||void 0===s||s.srcElement.classList.add("treeselect-input--opened"):null===(i=t(this,Be))||void 0===i||i.srcElement.classList.remove("treeselect-input--opened"),this.staticList?null===(n=t(this,He))||void 0===n||n.srcElement.classList.add("treeselect-list--static"):null===(l=t(this,He))||void 0===l||l.srcElement.classList.remove("treeselect-list--static")}function ds(e){t(this,Pe)&&t(this,Ne)&&t(this,Ge)&&t(this,je)&&(this.alwaysOpen&&!e||(window.removeEventListener("scroll",t(this,Pe),!0),window.removeEventListener("resize",t(this,Ne))),document.removeEventListener("click",t(this,Ge),!0),document.removeEventListener("focus",t(this,Ge),!0),window.removeEventListener("blur",t(this,je)))}function us(){var t;null===(t=this.srcElement)||void 0===t||t.dispatchEvent(new CustomEvent("input",{detail:this.value})),this.inputCallback&&this.inputCallback(this.value)}var ps=class{mount(){var e;this.destroy();const{container:n,list:l,input:o}=i(this,qe,Ze).call(this);this.srcElement=n,s(this,He,l),s(this,Be,o),s(this,Pe,this.scrollWindowHandler.bind(this)),s(this,Ne,this.scrollWindowHandler.bind(this)),s(this,Ge,this.focusWindowHandler.bind(this)),s(this,je,this.blurWindowHandler.bind(this)),this.alwaysOpen&&(null===(e=t(this,Be))||void 0===e||e.openClose()),this.disabled&&this.srcElement.classList.add("treeselect--disabled")}updateValue(e){const s=t(this,He);if(s){var i;s.updateValue(e);const{groupedNodes:n,nodes:l}=s.selectedNodes,o=this.grouped?n:l;null===(i=t(this,Be))||void 0===i||i.updateValue(o)}}destroy(){this.srcElement&&(i(this,Ye,cs).call(this),this.srcElement.innerHTML="",this.srcElement=null,i(this,Xe,ds).call(this,!0))}focus(){t(this,Be)&&t(this,Be).focus()}toggleOpenClose(){t(this,Be)&&(t(this,Be).openClose(),t(this,Be).focus())}scrollWindowHandler(){this.updateListPosition()}focusWindowHandler(e){var s,n;var l;(null===(s=this.srcElement)||void 0===s?void 0:s.contains(e.target))||(null===(n=t(this,He))||void 0===n?void 0:n.srcElement.contains(e.target))||(null===(l=t(this,Be))||void 0===l||l.blur(),i(this,Xe,ds).call(this,!1),i(this,Je,hs).call(this,!1))}blurWindowHandler(){var e;null===(e=t(this,Be))||void 0===e||e.blur(),i(this,Xe,ds).call(this,!1),i(this,Je,hs).call(this,!1)}updateListPosition(){var e;const s=this.srcElement,n=null===(e=t(this,He))||void 0===e?void 0:e.srcElement;if(!s||!n)return;n.style.transform="";const{y:l,height:o}=n.getBoundingClientRect(),{x:c,y:a,height:h,width:r}=s.getBoundingClientRect(),d=window.innerHeight-a-h,u=a>d&&a>=o&&d<o;this.appendToBody&&(n.style.transform=u?`translateY(${a-l-o}px)`:`translateY(${a+h-l}px)`,n.style.width=`${r}px`,n.style.left=`${c+window.scrollX}px`);const p=u?"top":"bottom";n.getAttribute("direction")!==p&&(n.setAttribute("direction",p),i(this,Fe,as).call(this,u,this.appendToBody))}constructor({parentHtmlContainer:t,value:s,options:i,openLevel:l,appendToBody:o,alwaysOpen:a,showTags:h,tagsCountText:r,clearable:d,searchable:u,placeholder:p,grouped:m,listSlotHtmlComponent:v,disabled:w,emptyText:f,staticList:E,id:k,iconElements:g,inputCallback:L}){n(this,qe),n(this,De),n(this,Ie),n(this,Ve),n(this,$e),n(this,Re),n(this,ze),n(this,Ue),n(this,Ye),n(this,Fe),n(this,Je),n(this,Ke),n(this,Xe),n(this,Qe),e(this,He,{writable:!0,value:null}),e(this,Be,{writable:!0,value:null}),e(this,Me,{writable:!0,value:null}),e(this,Pe,{writable:!0,value:null}),e(this,Ne,{writable:!0,value:null}),e(this,Ge,{writable:!0,value:null}),e(this,je,{writable:!0,value:null}),(({parentHtmlContainer:t,staticList:e,appendToBody:s})=>{t||console.error("Validation: parentHtmlContainer prop is required!"),e&&s&&console.error("Validation: You should set staticList to false if you use appendToBody!")})({parentHtmlContainer:t,staticList:E,appendToBody:o}),this.parentHtmlContainer=t,this.value=null!=s?s:[],this.options=null!=i?i:[],this.openLevel=null!=l?l:0,this.appendToBody=null==o||o,this.alwaysOpen=!(!a||w),this.showTags=null==h||h,this.tagsCountText=null!=r?r:"elements selected",this.clearable=null==d||d,this.searchable=null==u||u,this.placeholder=null!=p?p:"Search...",this.grouped=null==m||m,this.listSlotHtmlComponent=null!=v?v:null,this.disabled=null!=w&&w,this.emptyText=null!=f?f:"No results found...",this.staticList=!(!E||this.appendToBody),this.id=null!=k?k:"",this.iconElements=c(g),this.inputCallback=L,this.isListOpened=!1,this.srcElement=null,this.mount()}};export{ps as default};